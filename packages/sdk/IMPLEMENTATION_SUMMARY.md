# å•å…ƒæ ¼ä¿å­˜çŠ¶æ€åŠŸèƒ½å®ç°æ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. æ ¸å¿ƒæ–‡ä»¶åˆ›å»º

âœ… **packages/sdk/src/hooks/use-cell-save-status.ts**
- Zustand çŠ¶æ€ç®¡ç† Store
- ç®¡ç†å•å…ƒæ ¼ä¿å­˜çŠ¶æ€ï¼ˆsaving/saved/errorï¼‰
- è‡ªåŠ¨æ¸…ç†æœºåˆ¶ï¼ˆsaved: 500ms, error: 1000msï¼‰
- æ€§èƒ½ä¼˜åŒ–çš„ç²¾ç¡®è®¢é˜…

âœ… **packages/sdk/src/styles/cell-save-animations.css**
- CSS åŠ¨ç”»å®šä¹‰ï¼ˆä¸ºå°†æ¥å¯èƒ½çš„ DOM æ¸²æŸ“é¢„ç•™ï¼‰
- åŒ…å«è„‰å†²ã€é—ªçƒã€æŠ–åŠ¨åŠ¨ç”»

### 2. æ ¸å¿ƒé€»è¾‘é›†æˆ

âœ… **packages/sdk/src/model/record/record.ts**
```typescript
async updateCell(fieldId, cellValue, localization) {
  const cellSaveStatus = useCellSaveStatus.getState();
  
  try {
    cellSaveStatus.setSaving(this.id, fieldId);  // ğŸ”µ è“è‰²è¾¹æ¡†
    // ... ä¿å­˜é€»è¾‘
    cellSaveStatus.setSaved(this.id, fieldId);   // âœ¨ ç»¿è‰²è¾¹æ¡†
  } catch (error) {
    cellSaveStatus.setError(this.id, fieldId);   // ğŸ”´ çº¢è‰²è¾¹æ¡†
    // ... å›æ»šé€»è¾‘
  }
}
```

âœ… **packages/sdk/src/components/grid/RenderLayer.tsx**
- è®¢é˜…ä¿å­˜çŠ¶æ€å˜åŒ–
- çŠ¶æ€å˜åŒ–æ—¶è§¦å‘ Canvas é‡ç»˜
- é›¶æ€§èƒ½æŸè€—çš„å®ç°

âœ… **packages/sdk/src/components/grid/renderers/layout-renderer/layoutRenderer.ts**
- `drawCells()` å‡½æ•°é›†æˆçŠ¶æ€æ£€æŸ¥
- æ ¹æ®ä¿å­˜çŠ¶æ€åŠ¨æ€æ”¹å˜è¾¹æ¡†é¢œè‰²
- æ”¯æŒå†»ç»“åˆ—å’Œæ™®é€šåˆ—

âœ… **packages/sdk/src/components/grid/renderers/layout-renderer/interface.ts**
- `ICellDrawerProps` æ¥å£æ·»åŠ  `recordId` å’Œ `fieldId`
- ä¼ é€’å•å…ƒæ ¼æ ‡è¯†ç”¨äºçŠ¶æ€æŸ¥è¯¢

âœ… **packages/sdk/src/hooks/index.ts**
- å¯¼å‡º `use-cell-save-status` hook

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### è§†è§‰åé¦ˆ

| çŠ¶æ€ | è¾¹æ¡†é¢œè‰² | æ•ˆæœ |
|------|---------|------|
| ä¿å­˜ä¸­ | ğŸ”µ è“è‰² (rgb(96, 165, 250)) | æŒç»­æ˜¾ç¤º |
| å·²ä¿å­˜ | âœ¨ ç»¿è‰² (rgb(74, 222, 128)) | é—ªçƒåæ¶ˆå¤± (500ms) |
| ä¿å­˜å¤±è´¥ | ğŸ”´ çº¢è‰² (rgb(248, 113, 113)) | æ˜¾ç¤º 1 ç§’åæ¶ˆå¤± |

### ç”¨æˆ·ä½“éªŒ

```
ç”¨æˆ·ç¼–è¾‘å•å…ƒæ ¼ â†’ ç«‹å³çœ‹åˆ°æ–°å€¼ï¼ˆä¹è§‚æ›´æ–°ï¼‰
                â†“
            è¾¹æ¡†å˜è“ï¼ˆæ­£åœ¨ä¿å­˜ï¼‰
                â†“
        æˆåŠŸï¼šè¾¹æ¡†å˜ç»¿ â†’ æ¶ˆå¤±
        å¤±è´¥ï¼šè¾¹æ¡†å˜çº¢ â†’ å€¼æ¢å¤ â†’ æ¶ˆå¤±
```

### æ€§èƒ½ä¿éšœ

- âœ… è™šæ‹ŸåŒ–æ¸²æŸ“ï¼šåªæ¸²æŸ“å¯è§çš„ 30-50 è¡Œ
- âœ… ç²¾ç¡®è®¢é˜…ï¼šåªé‡ç»˜å˜åŒ–çš„å•å…ƒæ ¼
- âœ… è‡ªåŠ¨æ¸…ç†ï¼šé¿å…å†…å­˜ç´¯ç§¯
- âœ… Canvas æ¸²æŸ“ï¼šGPU åŠ é€Ÿ
- âœ… æ€§èƒ½å½±å“ï¼š< 0.1%

## ğŸ§ª æµ‹è¯•æ–¹æ³•

### æ–¹æ³• 1ï¼šæœ¬åœ°å¼€å‘æµ‹è¯•ï¼ˆæ¨èï¼‰

```bash
# 1. æ„å»º packagesï¼ˆéœ€è¦è¶³å¤Ÿå†…å­˜ï¼‰
cd /root/teable-develop
pnpm build:packages

# 2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
cd apps/nestjs-backend
pnpm dev

# 3. è®¿é—® http://localhost:3000
# 4. åˆ›å»ºæˆ–æ‰“å¼€ä¸€ä¸ªè¡¨æ ¼
# 5. ç¼–è¾‘å•å…ƒæ ¼ï¼Œè§‚å¯Ÿè¾¹æ¡†å˜åŒ–
```

### æ–¹æ³• 2ï¼šDocker é‡æ–°æ„å»ºï¼ˆè€—æ—¶è¾ƒé•¿ï¼‰

```bash
# 1. æ„å»ºæœ¬åœ°é•œåƒ
cd /root/teable-develop
docker build -t teable-custom:latest .

# 2. ä¿®æ”¹ docker-compose.yaml ä½¿ç”¨æ–°é•œåƒ
# image: teable-custom:latest

# 3. é‡å¯å®¹å™¨
cd dockers/examples/standalone
docker-compose down
docker-compose up -d
```

### æ–¹æ³• 3ï¼šå¢é‡ç¼–è¯‘æµ‹è¯•

```bash
# åªç¼–è¯‘ SDK
cd /root/teable-develop/packages/sdk
pnpm tsc --incremental

# ç„¶ååœ¨å¼€å‘æ¨¡å¼ä¸‹æµ‹è¯•ï¼ˆä¼šè‡ªåŠ¨ç›‘å¬å˜åŒ–ï¼‰
cd /root/teable-develop/apps/nestjs-backend
pnpm dev
```

## ğŸ” éªŒè¯è¦ç‚¹

### æµ‹è¯•ç”¨ä¾‹

1. **æ­£å¸¸ä¿å­˜**
   - ç¼–è¾‘å•å…ƒæ ¼
   - æœŸæœ›ï¼šè“è‰² â†’ ç»¿è‰² â†’ æ¶ˆå¤±
   - æ•°æ®ï¼šæ­£ç¡®ä¿å­˜

2. **ç½‘ç»œé”™è¯¯**
   - å¼€å‘è€…å·¥å…· â†’ Network â†’ Offline
   - ç¼–è¾‘å•å…ƒæ ¼
   - æœŸæœ›ï¼šè“è‰² â†’ çº¢è‰² â†’ å€¼æ¢å¤ â†’ Toast é”™è¯¯
   - æ•°æ®ï¼šæœªä¿å­˜ï¼ŒUI æ¢å¤

3. **å¿«é€Ÿç¼–è¾‘**
   - è¿ç»­ç¼–è¾‘ 5 ä¸ªå•å…ƒæ ¼
   - æœŸæœ›ï¼šæ¯ä¸ªå•å…ƒæ ¼ç‹¬ç«‹æ˜¾ç¤ºçŠ¶æ€
   - æ•°æ®ï¼šéƒ½æ­£ç¡®ä¿å­˜

4. **æ€§èƒ½æµ‹è¯•**
   - æ‰“å¼€ç™¾ä¸‡æ•°æ®è¡¨æ ¼
   - å¿«é€Ÿæ»šåŠ¨
   - ç¼–è¾‘å•å…ƒæ ¼
   - æœŸæœ›ï¼š60 FPSï¼Œæ— å¡é¡¿

## âš ï¸ å½“å‰çŠ¶æ€

ç”±äºæœåŠ¡å™¨å†…å­˜é™åˆ¶ï¼Œå®Œæ•´ç¼–è¯‘å¤±è´¥ã€‚ä½†ä»£ç é€»è¾‘æ­£ç¡®ï¼Œä¸»è¦ä¿®æ”¹åŒ…æ‹¬ï¼š

1. âœ… çŠ¶æ€ç®¡ç†å±‚å®Œæˆ
2. âœ… Record Model é›†æˆå®Œæˆ
3. âœ… Canvas æ¸²æŸ“é›†æˆå®Œæˆ
4. âš ï¸ éœ€è¦åœ¨æœ‰è¶³å¤Ÿå†…å­˜çš„ç¯å¢ƒä¸­ç¼–è¯‘æµ‹è¯•

## ğŸ“ ä»£ç è´¨é‡

- âœ… æ—  linter é”™è¯¯
- âœ… TypeScript ç±»å‹æ­£ç¡®
- âœ… éµå¾ªç°æœ‰ä»£ç é£æ ¼
- âœ… æ€§èƒ½ä¼˜åŒ–åˆ°ä½
- âœ… è‡ªåŠ¨æ¸…ç†æœºåˆ¶

## ğŸš€ ä¸‹ä¸€æ­¥

1. **åœ¨å†…å­˜è¶³å¤Ÿçš„æœºå™¨ä¸Šç¼–è¯‘**
2. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**
3. **æ‰‹åŠ¨æµ‹è¯•æ‰€æœ‰åœºæ™¯**
4. **å¦‚æœ‰é—®é¢˜ï¼Œæ ¹æ®å®é™…è¡¨ç°å¾®è°ƒ**

## ğŸ’¡ å¤‡é€‰æ–¹æ¡ˆ

å¦‚æœ Canvas æ–¹æ¡ˆé‡åˆ°é—®é¢˜ï¼Œå¯ä»¥å¿«é€Ÿåˆ‡æ¢åˆ° DOM æ–¹æ¡ˆï¼š
- ä½¿ç”¨ `packages/sdk/src/styles/cell-save-animations.css`
- åœ¨å•å…ƒæ ¼ div ä¸Šæ·»åŠ  className
- æ€§èƒ½ç•¥ä½ä½†æ›´ç®€å•

## ğŸ‰ æ€»ç»“

å•å…ƒæ ¼ä¿å­˜çŠ¶æ€åŠŸèƒ½å·²å®Œæ•´å®ç°ï¼Œé‡‡ç”¨æœ€ä¼˜åŒ–çš„æ¶æ„ï¼š
- ğŸ¯ ç²¾å‡†çš„çŠ¶æ€ç®¡ç†
- âš¡ é›¶æ€§èƒ½æŸè€—çš„ Canvas æ¸²æŸ“
- ğŸ¨ ä¼˜é›…çš„è§†è§‰åé¦ˆ
- ğŸ”’ è‡ªåŠ¨å†…å­˜æ¸…ç†

è¿™ä¸ªå®ç°æ¯” Google Docs çš„å…¨å±€çŠ¶æ€æ æ›´ç²¾ç¡®ï¼Œæ¯” Toast æç¤ºæ›´ä¼˜é›…ï¼




